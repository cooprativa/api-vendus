{"version":3,"sources":["vite.config.js"],"names":["nativeFetch","process","env","HOST","startsWith","SHOPIFY_APP_URL","appUrl","URL","e","console","error","message","host","hostname","hmrConfig","protocol","port","clientPort","parseInt","FRONTEND_PORT","server","allowedHosts","cors","preflightContinue","Number","PORT","hmr","fs","allow","plugins","serverModuleFormat","ignoredRouteFiles","future","v3_fetcherPersist","v3_relativeSplatPath","v3_throwAbortReason","v3_lazyRouteDiscovery","v3_singleFetch","v3_routeConfig","build","assetsInlineLimit","optimizeDeps","include","ssr","external"],"mappings":"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","sourcesContent":["// vite.config.js\r\n\r\nimport { vitePlugin as remix } from \"@remix-run/dev\";\r\nimport { installGlobals } from \"@remix-run/node\";\r\nimport { defineConfig } from \"vite\";\r\nimport tsconfigPaths from \"vite-tsconfig-paths\";\r\n\r\ninstallGlobals({ nativeFetch: true });\r\n\r\n// Handle process.env.HOST which might be set by development tools\r\n// Ensure SHOPIFY_APP_URL is always a full URL with a protocol\r\nif (process.env.HOST) {\r\n  if (!process.env.HOST.startsWith('http://') && !process.env.HOST.startsWith('https://')) {\r\n    // If HOST is just a hostname, prepend https://\r\n    process.env.SHOPIFY_APP_URL = `https://${process.env.HOST}`;\r\n  } else {\r\n    // If HOST is already a full URL, use it directly\r\n    process.env.SHOPIFY_APP_URL = process.env.HOST;\r\n  }\r\n  delete process.env.HOST; // Clean up the HOST variable\r\n}\r\n\r\n// Safely parse SHOPIFY_APP_URL, falling back to a valid localhost URL\r\nlet appUrl;\r\ntry {\r\n  appUrl = new URL(process.env.SHOPIFY_APP_URL || \"http://localhost\");\r\n} catch (e) {\r\n  console.error(\r\n    \"Invalid SHOPIFY_APP_URL environment variable. Falling back to http://localhost. Error:\",\r\n    e.message\r\n  );\r\n  appUrl = new URL(\"http://localhost\");\r\n}\r\n\r\nconst host = appUrl.hostname;\r\nlet hmrConfig;\r\n\r\nif (host === \"localhost\") {\r\n  hmrConfig = {\r\n    protocol: \"ws\",\r\n    host: \"localhost\",\r\n    port: 64999,\r\n    clientPort: 64999,\r\n  };\r\n} else {\r\n  hmrConfig = {\r\n    protocol: \"wss\",\r\n    host: host,\r\n    port: parseInt(process.env.FRONTEND_PORT) || 8002,\r\n    clientPort: 443,\r\n  };\r\n}\r\n\r\nexport default defineConfig({\r\n  server: {\r\n    // Add the Cloudflare Tunnel hostname to allowedHosts\r\n    allowedHosts: [host,'youth-cost-advance-animated.trycloudflare.com','tourist-flickr-societies-numbers.trycloudflare.com','achieving-superior-campaigns-acoustic.trycloudflare.com','textbook-deluxe-properties-inform.trycloudflare.com' , 'vehicle-doctor-brakes-dress.trycloudflare.com' , 'acquired-store-clips-yourself.trycloudflare.com' , 'assembly-pt-barry-cindy.trycloudflare.com', 'https://b9a0-2001-818-dcec-f800-3992-38fc-f3f1-3be1.ngrok-free.app','assembly-pt-barry-cindy.trycloudflare.com', 'wool-clinic-standing-cities.trycloudflare.com', 'http://localhost:3000','teams-wait-rise-ve.trycloudflare.com' , 'damage-platforms-blessed-woods.trycloudflare.com', 'damage-platforms-blessed-woods.trycloudflare.com', 'damage-platforms-blessed-woods.trycloudflare.com', 'prescription-screenshot-calculation-evaluations.trycloudflare.com', 'complement-losing-commissions-wrap.trycloudflare.com', 'emotional-regularly-boy-mls.trycloudflare.com', 'clothes-assumptions-globe-van.trycloudflare.com', 'canal-fellowship-downloading-kai.trycloudflare.com', 'e77b-2001-818-dcec-f800-39a8-e93f-fb40-34a.ngrok-free.app'],\r\n    cors: {\r\n      preflightContinue: true,\r\n    },\r\n    port: Number(process.env.PORT || 3000),\r\n    hmr: hmrConfig,\r\n    fs: {\r\n      // See https://vitejs.dev/config/server-options.html#server-fs-allow for more information\r\n      allow: [\"app\", \"node_modules\"],\r\n    },\r\n  },\r\n  plugins: [\r\n    remix({\r\n      serverModuleFormat: \"esm\", // Keep this for ESM output\r\n      ignoredRouteFiles: [\"**/.*\"],\r\n      future: {\r\n        v3_fetcherPersist: true,\r\n        v3_relativeSplatPath: true,\r\n        v3_throwAbortReason: true,\r\n        v3_lazyRouteDiscovery: true,\r\n        v3_singleFetch: false,\r\n        v3_routeConfig: true,\r\n      },\r\n    }),\r\n    tsconfigPaths(),\r\n  ],\r\n  build: {\r\n    assetsInlineLimit: 0,\r\n  },\r\n  optimizeDeps: {\r\n    include: [\"@shopify/app-bridge-react\", \"@shopify/polaris\"],\r\n  },\r\n  // THIS IS THE MODIFIED SSR BLOCK\r\n  ssr: {\r\n    // Explicitly externalize these packages.\r\n    // This tells Vite *NOT* to bundle or transform them.\r\n    // It assumes Node.js itself will correctly load these CommonJS packages\r\n    // at runtime, leveraging Node's built-in CJS-ESM interop.\r\n    external: [\r\n      \"express\",             // Original 'require' error culprit\r\n      \"@remix-run/express\",  // Current 'exports' error culprit\r\n      \"@remix-run/node\",     // Likely also problematic CJS internally\r\n      \"http\",                // Node.js built-in module, should always be external\r\n    ],\r\n  },\r\n});\r\n"],"file":"vite.config.dev.js"}